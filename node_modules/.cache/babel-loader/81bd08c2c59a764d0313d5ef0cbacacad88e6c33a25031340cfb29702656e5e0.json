{"ast":null,"code":"\"use client\";\n\nvar _jsxFileName = \"D:\\\\avaltree_react_final\\\\react-tailwind-starter\\\\src\\\\components\\\\RaffleWidget.jsx\",\n  _s = $RefreshSig$();\nimport { useState, useEffect, forwardRef, useImperativeHandle } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst RaffleWidget = /*#__PURE__*/_s(/*#__PURE__*/forwardRef(_c = _s(({\n  userId\n}, ref) => {\n  _s();\n  const [ticketCount, setTicketCount] = useState(0);\n  const [isLoading, setIsLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Fetch raffle status\n  const fetchRaffleStatus = async () => {\n    try {\n      setIsLoading(true);\n      const response = await fetch(`http://localhost:3001/api/raffle-status?userId=${userId}`);\n      console.log(\"raffle widget is:\", response);\n      if (!response.ok) {\n        throw new Error('Failed to fetch raffle status');\n      }\n      const data = await response.json();\n      setTicketCount(data.ticketCount || 0);\n      console.log('✅ Raffle status updated:', data.ticketCount, 'tickets');\n    } catch (err) {\n      setError(err.message);\n      console.error('Error fetching raffle status:', err);\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  // Expose refresh function to parent components\n  useImperativeHandle(ref, () => ({\n    refresh: fetchRaffleStatus\n  }));\n\n  // Trigger raffle award\n  const triggerRaffleAward = async () => {\n    try {\n      const response = await fetch('http://localhost:3001/api/raffle-award', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          userId\n        })\n      });\n      if (!response.ok) {\n        throw new Error('Failed to trigger raffle award');\n      }\n      const data = await response.json();\n\n      // Refresh raffle status after award\n      await fetchRaffleStatus();\n\n      // Show success message\n      alert(`Congratulations! You won: ${data.prize}`);\n    } catch (err) {\n      setError(err.message);\n      console.error('Error triggering raffle award:', err);\n    }\n  };\n  useEffect(() => {\n    if (userId) {\n      fetchRaffleStatus();\n    }\n  }, [userId]);\n\n  // Auto-refresh every 30 seconds\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (userId) {\n        fetchRaffleStatus();\n      }\n    }, 30000);\n    return () => clearInterval(interval);\n  }, [userId]);\n  if (isLoading) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white/10 backdrop-blur-md rounded-lg p-4 border border-white/20\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"animate-pulse\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-4 bg-white/20 rounded mb-2\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 86,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"h-6 bg-white/20 rounded\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 87,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 85,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-500/10 backdrop-blur-md rounded-lg p-4 border border-red-500/20\",\n      children: /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-red-400 text-sm\",\n        children: \"Error loading raffle status\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 96,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 95,\n      columnNumber: 7\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-white/10 backdrop-blur-md rounded-lg p-4 border border-black/20\",\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      className: \"text-lg font-heading font-semibold text-black mb-2\",\n      children: \"\\uD83C\\uDFB0 Raffle Tickets\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 103,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between mb-3\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-black/80 text-sm\",\n        children: \"Your Tickets:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 108,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-2xl font-bold text-black\",\n        children: ticketCount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 109,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-2\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-black/60 mb-2\",\n        children: ticketCount > 0 ? \"You have tickets in the current raffle!\" : \"Purchase to get raffle tickets!\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 113,\n        columnNumber: 9\n      }, this), ticketCount > 0 && /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: triggerRaffleAward,\n        className: \"w-full bg-black/90 hover:bg-black/60 text-white font-body font-semibold py-2 px-4 rounded-lg transition-colors duration-200 text-sm\",\n        children: \"\\uD83C\\uDF81 Claim Prize\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 121,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 112,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-3 pt-3 border-t border-white/10\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-xs text-white/50\",\n        children: [\"Next draw: \", new Date(Date.now() + 24 * 60 * 60 * 1000).toLocaleDateString()]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 102,\n    columnNumber: 5\n  }, this);\n}, \"OoPvGPnTbb+GbD2x8msZUZ4ReJg=\")), \"OoPvGPnTbb+GbD2x8msZUZ4ReJg=\");\n_c2 = RaffleWidget;\nRaffleWidget.displayName = 'RaffleWidget';\nexport default RaffleWidget;\nvar _c, _c2;\n$RefreshReg$(_c, \"RaffleWidget$forwardRef\");\n$RefreshReg$(_c2, \"RaffleWidget\");","map":{"version":3,"names":["_jsxFileName","_s","$RefreshSig$","useState","useEffect","forwardRef","useImperativeHandle","jsxDEV","_jsxDEV","RaffleWidget","_c","userId","ref","ticketCount","setTicketCount","isLoading","setIsLoading","error","setError","fetchRaffleStatus","response","fetch","console","log","ok","Error","data","json","err","message","refresh","triggerRaffleAward","method","headers","body","JSON","stringify","alert","prize","interval","setInterval","clearInterval","className","children","fileName","lineNumber","columnNumber","onClick","Date","now","toLocaleDateString","_c2","displayName","$RefreshReg$"],"sources":["D:/avaltree_react_final/react-tailwind-starter/src/components/RaffleWidget.jsx"],"sourcesContent":["\"use client\"\n\nimport { useState, useEffect, forwardRef, useImperativeHandle } from \"react\"\n\nconst RaffleWidget = forwardRef(({ userId }, ref) => {\n  const [ticketCount, setTicketCount] = useState(0)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState(null)\n\n  // Fetch raffle status\n  const fetchRaffleStatus = async () => {\n    try {\n      setIsLoading(true)\n      const response = await fetch(`http://localhost:3001/api/raffle-status?userId=${userId}`);\n      console.log(\"raffle widget is:\",response);\n      \n      if (!response.ok) {\n        throw new Error('Failed to fetch raffle status')\n      }\n      \n      const data = await response.json()\n      setTicketCount(data.ticketCount || 0)\n      console.log('✅ Raffle status updated:', data.ticketCount, 'tickets')\n    } catch (err) {\n      setError(err.message)\n      console.error('Error fetching raffle status:', err)\n    } finally {\n      setIsLoading(false)\n    }\n  }\n\n  // Expose refresh function to parent components\n  useImperativeHandle(ref, () => ({\n    refresh: fetchRaffleStatus\n  }))\n\n  // Trigger raffle award\n  const triggerRaffleAward = async () => {\n    try {\n      const response = await fetch('http://localhost:3001/api/raffle-award', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ userId }),\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to trigger raffle award')\n      }\n\n      const data = await response.json()\n      \n      // Refresh raffle status after award\n      await fetchRaffleStatus()\n      \n      // Show success message\n      alert(`Congratulations! You won: ${data.prize}`)\n    } catch (err) {\n      setError(err.message)\n      console.error('Error triggering raffle award:', err)\n    }\n  }\n\n  useEffect(() => {\n    if (userId) {\n      fetchRaffleStatus()\n    }\n  }, [userId])\n\n  // Auto-refresh every 30 seconds\n  useEffect(() => {\n    const interval = setInterval(() => {\n      if (userId) {\n        fetchRaffleStatus()\n      }\n    }, 30000)\n\n    return () => clearInterval(interval)\n  }, [userId])\n\n  if (isLoading) {\n    return (\n      <div className=\"bg-white/10 backdrop-blur-md rounded-lg p-4 border border-white/20\">\n        <div className=\"animate-pulse\">\n          <div className=\"h-4 bg-white/20 rounded mb-2\"></div>\n          <div className=\"h-6 bg-white/20 rounded\"></div>\n        </div>\n      </div>\n    )\n  }\n\n  if (error) {\n    return (\n      <div className=\"bg-red-500/10 backdrop-blur-md rounded-lg p-4 border border-red-500/20\">\n        <p className=\"text-red-400 text-sm\">Error loading raffle status</p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"bg-white/10 backdrop-blur-md rounded-lg p-4 border border-black/20\">\n      <h3 className=\"text-lg font-heading font-semibold text-black mb-2\">\n        🎰 Raffle Tickets\n      </h3>\n      \n      <div className=\"flex items-center justify-between mb-3\">\n        <span className=\"text-black/80 text-sm\">Your Tickets:</span>\n        <span className=\"text-2xl font-bold text-black\">{ticketCount}</span>\n      </div>\n\n      <div className=\"space-y-2\">\n        <div className=\"text-xs text-black/60 mb-2\">\n          {ticketCount > 0 \n            ? \"You have tickets in the current raffle!\" \n            : \"Purchase to get raffle tickets!\"\n          }\n        </div>\n        \n        {ticketCount > 0 && (\n          <button\n            onClick={triggerRaffleAward}\n            className=\"w-full bg-black/90 hover:bg-black/60 text-white font-body font-semibold py-2 px-4 rounded-lg transition-colors duration-200 text-sm\"\n          >\n            🎁 Claim Prize\n          </button>\n        )}\n      </div>\n\n      <div className=\"mt-3 pt-3 border-t border-white/10\">\n        <div className=\"text-xs text-white/50\">\n          Next draw: {new Date(Date.now() + 24 * 60 * 60 * 1000).toLocaleDateString()}\n        </div>\n      </div>\n    </div>\n  )\n})\n\nRaffleWidget.displayName = 'RaffleWidget'\n\nexport default RaffleWidget\n"],"mappings":"AAAA,YAAY;;AAAA,IAAAA,YAAA;EAAAC,EAAA,GAAAC,YAAA;AAEZ,SAASC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,EAAEC,mBAAmB,QAAQ,OAAO;AAAA,SAAAC,MAAA,IAAAC,OAAA;AAE5E,MAAMC,YAAY,gBAAAR,EAAA,cAAGI,UAAU,CAAAK,EAAA,GAAAT,EAAA,CAAC,CAAC;EAAEU;AAAO,CAAC,EAAEC,GAAG,KAAK;EAAAX,EAAA;EACnD,MAAM,CAACY,WAAW,EAAEC,cAAc,CAAC,GAAGX,QAAQ,CAAC,CAAC,CAAC;EACjD,MAAM,CAACY,SAAS,EAAEC,YAAY,CAAC,GAAGb,QAAQ,CAAC,IAAI,CAAC;EAChD,MAAM,CAACc,KAAK,EAAEC,QAAQ,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;;EAExC;EACA,MAAMgB,iBAAiB,GAAG,MAAAA,CAAA,KAAY;IACpC,IAAI;MACFH,YAAY,CAAC,IAAI,CAAC;MAClB,MAAMI,QAAQ,GAAG,MAAMC,KAAK,CAAC,kDAAkDV,MAAM,EAAE,CAAC;MACxFW,OAAO,CAACC,GAAG,CAAC,mBAAmB,EAACH,QAAQ,CAAC;MAEzC,IAAI,CAACA,QAAQ,CAACI,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAAC,+BAA+B,CAAC;MAClD;MAEA,MAAMC,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;MAClCb,cAAc,CAACY,IAAI,CAACb,WAAW,IAAI,CAAC,CAAC;MACrCS,OAAO,CAACC,GAAG,CAAC,0BAA0B,EAAEG,IAAI,CAACb,WAAW,EAAE,SAAS,CAAC;IACtE,CAAC,CAAC,OAAOe,GAAG,EAAE;MACZV,QAAQ,CAACU,GAAG,CAACC,OAAO,CAAC;MACrBP,OAAO,CAACL,KAAK,CAAC,+BAA+B,EAAEW,GAAG,CAAC;IACrD,CAAC,SAAS;MACRZ,YAAY,CAAC,KAAK,CAAC;IACrB;EACF,CAAC;;EAED;EACAV,mBAAmB,CAACM,GAAG,EAAE,OAAO;IAC9BkB,OAAO,EAAEX;EACX,CAAC,CAAC,CAAC;;EAEH;EACA,MAAMY,kBAAkB,GAAG,MAAAA,CAAA,KAAY;IACrC,IAAI;MACF,MAAMX,QAAQ,GAAG,MAAMC,KAAK,CAAC,wCAAwC,EAAE;QACrEW,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACP,cAAc,EAAE;QAClB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEzB;QAAO,CAAC;MACjC,CAAC,CAAC;MAEF,IAAI,CAACS,QAAQ,CAACI,EAAE,EAAE;QAChB,MAAM,IAAIC,KAAK,CAAC,gCAAgC,CAAC;MACnD;MAEA,MAAMC,IAAI,GAAG,MAAMN,QAAQ,CAACO,IAAI,CAAC,CAAC;;MAElC;MACA,MAAMR,iBAAiB,CAAC,CAAC;;MAEzB;MACAkB,KAAK,CAAC,6BAA6BX,IAAI,CAACY,KAAK,EAAE,CAAC;IAClD,CAAC,CAAC,OAAOV,GAAG,EAAE;MACZV,QAAQ,CAACU,GAAG,CAACC,OAAO,CAAC;MACrBP,OAAO,CAACL,KAAK,CAAC,gCAAgC,EAAEW,GAAG,CAAC;IACtD;EACF,CAAC;EAEDxB,SAAS,CAAC,MAAM;IACd,IAAIO,MAAM,EAAE;MACVQ,iBAAiB,CAAC,CAAC;IACrB;EACF,CAAC,EAAE,CAACR,MAAM,CAAC,CAAC;;EAEZ;EACAP,SAAS,CAAC,MAAM;IACd,MAAMmC,QAAQ,GAAGC,WAAW,CAAC,MAAM;MACjC,IAAI7B,MAAM,EAAE;QACVQ,iBAAiB,CAAC,CAAC;MACrB;IACF,CAAC,EAAE,KAAK,CAAC;IAET,OAAO,MAAMsB,aAAa,CAACF,QAAQ,CAAC;EACtC,CAAC,EAAE,CAAC5B,MAAM,CAAC,CAAC;EAEZ,IAAII,SAAS,EAAE;IACb,oBACEP,OAAA;MAAKkC,SAAS,EAAC,oEAAoE;MAAAC,QAAA,eACjFnC,OAAA;QAAKkC,SAAS,EAAC,eAAe;QAAAC,QAAA,gBAC5BnC,OAAA;UAAKkC,SAAS,EAAC;QAA8B;UAAAE,QAAA,EAAA5C,YAAA;UAAA6C,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC,eACpDtC,OAAA;UAAKkC,SAAS,EAAC;QAAyB;UAAAE,QAAA,EAAA5C,YAAA;UAAA6C,UAAA;UAAAC,YAAA;QAAA,OAAM,CAAC;MAAA;QAAAF,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAC5C;IAAC;MAAAF,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAEV;EAEA,IAAI7B,KAAK,EAAE;IACT,oBACET,OAAA;MAAKkC,SAAS,EAAC,wEAAwE;MAAAC,QAAA,eACrFnC,OAAA;QAAGkC,SAAS,EAAC,sBAAsB;QAAAC,QAAA,EAAC;MAA2B;QAAAC,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAAG;IAAC;MAAAF,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OAChE,CAAC;EAEV;EAEA,oBACEtC,OAAA;IAAKkC,SAAS,EAAC,oEAAoE;IAAAC,QAAA,gBACjFnC,OAAA;MAAIkC,SAAS,EAAC,oDAAoD;MAAAC,QAAA,EAAC;IAEnE;MAAAC,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OAAI,CAAC,eAELtC,OAAA;MAAKkC,SAAS,EAAC,wCAAwC;MAAAC,QAAA,gBACrDnC,OAAA;QAAMkC,SAAS,EAAC,uBAAuB;QAAAC,QAAA,EAAC;MAAa;QAAAC,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAAM,CAAC,eAC5DtC,OAAA;QAAMkC,SAAS,EAAC,+BAA+B;QAAAC,QAAA,EAAE9B;MAAW;QAAA+B,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAAO,CAAC;IAAA;MAAAF,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OACjE,CAAC,eAENtC,OAAA;MAAKkC,SAAS,EAAC,WAAW;MAAAC,QAAA,gBACxBnC,OAAA;QAAKkC,SAAS,EAAC,4BAA4B;QAAAC,QAAA,EACxC9B,WAAW,GAAG,CAAC,GACZ,yCAAyC,GACzC;MAAiC;QAAA+B,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAElC,CAAC,EAELjC,WAAW,GAAG,CAAC,iBACdL,OAAA;QACEuC,OAAO,EAAEhB,kBAAmB;QAC5BW,SAAS,EAAC,qIAAqI;QAAAC,QAAA,EAChJ;MAED;QAAAC,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OAAQ,CACT;IAAA;MAAAF,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OACE,CAAC,eAENtC,OAAA;MAAKkC,SAAS,EAAC,oCAAoC;MAAAC,QAAA,eACjDnC,OAAA;QAAKkC,SAAS,EAAC,uBAAuB;QAAAC,QAAA,GAAC,aAC1B,EAAC,IAAIK,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAACC,kBAAkB,CAAC,CAAC;MAAA;QAAAN,QAAA,EAAA5C,YAAA;QAAA6C,UAAA;QAAAC,YAAA;MAAA,OACxE;IAAC;MAAAF,QAAA,EAAA5C,YAAA;MAAA6C,UAAA;MAAAC,YAAA;IAAA,OACH,CAAC;EAAA;IAAAF,QAAA,EAAA5C,YAAA;IAAA6C,UAAA;IAAAC,YAAA;EAAA,OACH,CAAC;AAEV,CAAC,kCAAC;AAAAK,GAAA,GApII1C,YAAY;AAsIlBA,YAAY,CAAC2C,WAAW,GAAG,cAAc;AAEzC,eAAe3C,YAAY;AAAA,IAAAC,EAAA,EAAAyC,GAAA;AAAAE,YAAA,CAAA3C,EAAA;AAAA2C,YAAA,CAAAF,GAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}